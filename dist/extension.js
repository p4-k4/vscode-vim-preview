(()=>{"use strict";var i,e={265:function(i,e,n){var t=this&&this.__createBinding||(Object.create?function(i,e,n,t){void 0===t&&(t=n);var s=Object.getOwnPropertyDescriptor(e,n);s&&!("get"in s?!e.__esModule:s.writable||s.configurable)||(s={enumerable:!0,get:function(){return e[n]}}),Object.defineProperty(i,t,s)}:function(i,e,n,t){void 0===t&&(t=n),i[t]=e[n]}),s=this&&this.__setModuleDefault||(Object.create?function(i,e){Object.defineProperty(i,"default",{enumerable:!0,value:e})}:function(i,e){i.default=e}),o=this&&this.__importStar||function(i){if(i&&i.__esModule)return i;var e={};if(null!=i)for(var n in i)"default"!==n&&Object.prototype.hasOwnProperty.call(i,n)&&t(e,i,n);return s(e,i),e};Object.defineProperty(e,"__esModule",{value:!0}),e.activate=function(i){const e=new u,n=r.commands.registerCommand("vscode-vim-preview.showKeyBindings",(()=>{e.showKeyBindings()}));i.subscriptions.push(n),i.subscriptions.push(e)},e.deactivate=function(){};const r=o(n(398)),c=o(n(928)),d=o(n(857)),a=o(n(896));class u{quickPick;disposables=[];normalModeBindings=[];visualModeBindings=[];vscodeBindings=[];leaderKey="\\";MAX_DESCRIPTION_LENGTH=50;constructor(){this.quickPick=r.window.createQuickPick(),this.quickPick.placeholder="Type to filter keybindings (keys, commands, or descriptions)...",this.quickPick.matchOnDescription=!0,this.quickPick.matchOnDetail=!0,this.disposables.push(this.quickPick),r.workspace.onDidChangeConfiguration((i=>{(i.affectsConfiguration("vim")||i.affectsConfiguration("keybindings"))&&this.updateBindings()}),null,this.disposables),this.updateBindings()}updateBindings(){const i=r.workspace.getConfiguration("vim");this.leaderKey=i.get("leader","\\"),this.normalModeBindings=i.get("normalModeKeyBindings",[]),this.visualModeBindings=i.get("visualModeKeyBindings",[]),this.loadVSCodeKeybindings()}getKeybindingsPath(){const i=d.platform(),e=d.homedir();switch(i){case"darwin":return c.join(e,"Library","Application Support","Code","User","keybindings.json");case"win32":return c.join(e,"AppData","Roaming","Code","User","keybindings.json");default:return c.join(e,".config","Code","User","keybindings.json")}}async loadVSCodeKeybindings(){try{const i=this.getKeybindingsPath();if(!a.existsSync(i))return;const e=a.readFileSync(i,"utf8"),t=(0,(await n.e(512).then(n.bind(n,512))).default)(e),s=JSON.parse(t);this.vscodeBindings=s.filter((i=>!(!i||"object"!=typeof i)&&"key"in i&&"command"in i&&!i.command.startsWith("-")))}catch(i){console.error("Error loading VSCode keybindings:",i),this.vscodeBindings=[]}}normalizeKey(i){return i.toLowerCase().replace(/\s+/g,"")}getCommandsString(i){return i.map((i=>"string"==typeof i?i:i.command)).join(", ")}truncateDescription(i){return!i||i.length<=this.MAX_DESCRIPTION_LENGTH?i||"":i.substring(0,this.MAX_DESCRIPTION_LENGTH-3)+"..."}isVimBinding(i){return"before"in i&&Array.isArray(i.before)}getMatchingBindings(i){const e=[],n=this.normalizeKey(i),t=[...this.normalModeBindings,...this.visualModeBindings];for(const i of t){if(!i.before||!Array.isArray(i.before))continue;const t=i.before.map((i=>"<leader>"===i?this.leaderKey:i)),s=t.join("").toLowerCase(),o=t.join(""),r=this.getCommandsString(i.commands),c=[s,r.toLowerCase(),i.description?.toLowerCase()||""].join(" ");if(c.includes(n)){const n=i.description?this.truncateDescription(i.description):"";e.push({binding:i,bindingType:"vim",label:`[Vim] ${o}`,description:n?`${n} - ${r}`:r,searchText:c,buttons:[]})}}for(const i of this.vscodeBindings){if(!i.key||!i.command)continue;const t=[i.key.toLowerCase(),i.command.toLowerCase(),i.description?.toLowerCase()||"",i.when?.toLowerCase()||""].join(" ");if(t.includes(n)){const n=i.description?this.truncateDescription(i.description):"";e.push({binding:i,bindingType:"vscode",label:`[VSCode] ${i.key}`,description:n?`${n} - ${i.command}${i.when?` (when: ${i.when})`:""}`:`${i.command}${i.when?` (when: ${i.when})`:""}`,searchText:t,buttons:[]})}}return e.sort(((i,e)=>{if(i.bindingType!==e.bindingType)return"vim"===i.bindingType?-1:1;const t=this.isVimBinding(i.binding)?i.binding.before.join("").toLowerCase().includes(n):i.binding.key.toLowerCase().includes(n),s=this.isVimBinding(e.binding)?e.binding.before.join("").toLowerCase().includes(n):e.binding.key.toLowerCase().includes(n);if(t&&!s)return-1;if(!t&&s)return 1;const o=i.binding.description||"",r=e.binding.description||"";return o.localeCompare(r)}))}async showKeyBindings(i=""){this.quickPick.value=i,this.quickPick.items=this.getMatchingBindings(i),this.quickPick.onDidChangeValue((i=>{this.quickPick.items=this.getMatchingBindings(i)})),this.quickPick.onDidAccept((()=>{const i=this.quickPick.selectedItems[0];if(i)if(this.isVimBinding(i.binding)){const e=i.binding.commands;Array.isArray(e)&&e.forEach((i=>{"string"==typeof i?r.commands.executeCommand(i):r.commands.executeCommand(i.command,i.args)}))}else r.commands.executeCommand(i.binding.command);this.quickPick.hide()})),this.quickPick.show()}dispose(){this.disposables.forEach((i=>i.dispose()))}}},398:i=>{i.exports=require("vscode")},896:i=>{i.exports=require("fs")},857:i=>{i.exports=require("os")},928:i=>{i.exports=require("path")}},n={};function t(i){var s=n[i];if(void 0!==s)return s.exports;var o=n[i]={exports:{}};return e[i].call(o.exports,o,o.exports,t),o.exports}t.m=e,t.d=(i,e)=>{for(var n in e)t.o(e,n)&&!t.o(i,n)&&Object.defineProperty(i,n,{enumerable:!0,get:e[n]})},t.f={},t.e=i=>Promise.all(Object.keys(t.f).reduce(((e,n)=>(t.f[n](i,e),e)),[])),t.u=i=>i+".extension.js",t.o=(i,e)=>Object.prototype.hasOwnProperty.call(i,e),t.r=i=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(i,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(i,"__esModule",{value:!0})},i={792:1},t.f.require=(e,n)=>{i[e]||(e=>{var n=e.modules,s=e.ids,o=e.runtime;for(var r in n)t.o(n,r)&&(t.m[r]=n[r]);o&&o(t);for(var c=0;c<s.length;c++)i[s[c]]=1})(require("./"+t.u(e)))};var s=t(265);module.exports=s})();